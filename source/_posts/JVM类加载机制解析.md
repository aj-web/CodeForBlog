---
title: JVM类加载机制解析
date: 2021年7月14日00:06:33
tags: JVM
------

# 1.1类加载机制
类加载步骤：加载 > > 验证 > > 准备 > > 解析 > > 初始化 > > 使用 > > 卸载
<!--more-->
- 加载：在硬盘上查找并通过IO读入字节码文件，使用到类时才会加载，例如调用类的main()方法，new对象等等，在加载阶段会在内存中生成一个代表这个类的java.lang.Class对象，作为方法区这个类的各种数据的访问入口
- 验证：校验字节码文件的正确性
- 准备：给类的静态变量分配内存，并赋予默认值
- 解析：将符号引用替换为直接引用，该阶段会把一些静态方法(符号引用，比如main()方法)替换为指向数据所存内存的指针或句柄等(直接引用)，这是所谓的静态链接过程(类加载期间完成)，动态链接是在程序运行期间完成的将符号引用替换为直接引用
- 初始化:对类的静态变量初始化为指定的值，执行静态代码块

>以上是类加载的5个阶段，那么除了类加载的5个阶段，还有：`使用`，`卸载`两个阶段   
>也就是类的生命周期=类加载+`使用`+`卸载`

### 1.1类加载机制拓展理解
有了上面的基本概念，我们再深层次的拓展一下：

加载：

- 加载会通过限定名(可以简单理解为类名)获取到类的二进制字节流
- 将二进制字节文件的数据放到方法区，然后在堆中生产一个代表这个类的java.lang.Class对象，Class 对象封装了类在方法区内的数据结构，并且向开发者提供了访问方法区内的数据结构的接口

所以我们可以认为，开发中用的是Class对象，但是当我们想要这个类的某些信息的时候，我们需要通过这个Class对象，到方法区中去找。例如类的`元数据`和`方法信息(继承信息、成员变量、静态变量、成员方法、构造函数)`。那么如何找到，就涉及到对象头中的一个Klass point:类型指针，通过类型指针来找到方法区中的元数据等。


# 2.类加载器和双亲委派机制
