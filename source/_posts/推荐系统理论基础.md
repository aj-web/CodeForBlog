---
title: 推荐系统理论基础
date: 2021年8月25日11:11:33
tags: 机器学习、推荐系统
------

>相信大家都在网上买过东西，那么各种各样的商城都会有类似猜你喜欢的推荐，不知道大家觉得这些推荐准嘛？可能准确率会因人而异，但是可以确定是，这种推荐系统对于提高销售额，一定是有帮助的，今天就来了解一下推荐系统
<!--more-->

# 1. 推荐系统功能介绍
## 1.1 推荐系统
&emsp;&emsp;推荐系统是利用电子商务网站向客户提供商品信息和建议，帮助用户决定应该购买什么产品，模拟销售人员帮助客户完成购买过程。个性化推荐是根据用户的兴趣特点和购买行为，向用户推荐用户感兴趣的信息和商品

## 1.2 定义
&emsp;&emsp;推荐系统有3个重要的模块：用户建模模块、推荐对象建模模块、推荐算法模块。通用的推荐系统模型流程如图。推荐系统把用户模型中兴趣需求信息和推荐对象模型中的特征信息匹配，同时使用相应的推荐算法进行计算筛选，找到用户可能感兴趣的推荐对象，然后推荐给用户。
![推荐系统](https://raw.githubusercontent.com/aj-web/picturebed/master/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AE%9A%E4%B9%89%E5%9B%BE.png)


# 2. 推荐系统实现
## 2.1 简单推荐系统思路？
例如：  
1.把每天打折的物品进行推荐？  
2.在订单表中找销售量最靠前的产品？  
&emsp;&emsp;上述也是比较简单的实现思路，但是并不智能，不能根据每个人的喜好来推荐，各大主流的购物网也明显不是采用这种方式来实现

&emsp;&emsp;所以要选择合适的推荐系统，我们需要了解推荐系统的作用：   
&emsp;&emsp;推荐系统要能够根据用户的信息需求，兴趣爱好等，将用户感兴趣的信息、产品等推荐给用户的个性化信息推荐系统。   
&emsp;&emsp;站在电商网站的角度，只是从销量或者打折这样单方面进行推荐，这样的推荐系统肯定是起不到吸引客户消费的目的。所以，好的推荐系统必须考虑到用户的喜好以及产品的特点。用户经常浏览以及购买什么物品，购买产品最多的人是年轻人还是老年人？那电商网站怎么知道用户的喜好，以及产品的受众呢？这就必须要基于大量用户和产品的数据，所以本次的推荐系统就是来带大家一起处理，收集，计算这些大量的用户以及产品的数据，通过机器学习的方式，形成一个有价值的推荐系统

## 2.2 推荐系统核心理解
&emsp;&emsp;推荐系统在我们实际生活中，可以有很多衍生场景。那这些推荐系统的核心到底是什么呢？其实推荐系统的真正核心可以理解为一个矩阵求解的数学问题。  
&emsp;&emsp;比如，网站向用户推荐商品，往往要基于用户以以往的浏览记录或者评价记录，而这些记录就可以抽象为（userid，productid，score）这样的一个向量结构，score可以是一个任意的数字，比如在这里表示用户的浏览次数，也可以是一个0或1的值，表示用户与商品之间是否建立了关系，比如是否购买过商品。而这样一些数据往往是比较零散的。当我们需要将这些数据整体进行梳理，就会以userid为一列，productid为一行，整理成这样一个矩阵。
![用户商品向量矩阵](https://raw.githubusercontent.com/aj-web/picturebed/master/%E7%94%A8%E6%88%B7%E5%95%86%E5%93%81%E5%90%91%E9%87%8F%E7%9F%A9%E9%98%B5.png)

&emsp;&emsp;一个向量数据,就代表了矩阵中的一个点，在这个矩阵中，数据通常是比较稀疏的，称为稀疏矩阵，而推荐算法要做的，就是将这些矩阵中的空白点，以某一种方法进行部分填充或者全部填充，每填充一个点，就代表向用户推荐这个产品的一个推荐指数，然后选举推荐指数比较高的产品推荐给客户。


## 2.3 推荐系统效果评价
&emsp;&emsp;针对上面想法，当我们有了数据之后，我们就可以把推荐系统这个抽象的理论问题，转换成一个具体的数学问题，但是这个问题并没有标准的答案，我们可以往里面填写任意的数字，即使当我们运用机器学习来预测，不同的模型，算法，也会预测出不同的结果，但是在众多的结果之中，总会有一些结果会更加适合大众的口味，虽然不同的推荐系统没有明确的分数来表示他的好坏，但是，最重他们还是会体现出不同层次的好坏。  
&emsp;&emsp;那么为什么会这样呢？从数学的角度来看待这个问题，就是因为我们自己设计的推荐系统没有很好的利用已有的数据，没有从已有数据中"学习"到内在的规律。而好的推荐系统则是通过机器学习很好的挖掘出了已有数据的一些内在规律，这些内在规律可以体现为每个用户的兴趣爱好，每个产品的最佳受众等等很多规律，甚至于很多人类无法描述的规律。  
&emsp;&emsp;比如最经典的啤酒和尿不湿要放在一起售卖的问题，这是一个机器学习中的经典故事，你可以强行做一些解释，但是总是很难接触到本质。所欲，对于推荐系统的评价需要基于非常多的维度进行综合评价。大致可以分为以下几类：

- 基于常识的评判标准  
  &emsp;&emsp;从上面我们已经知道了，推荐系统其实只是一个数字游戏，但是我们的业务不可能是简单的数字游戏。有一些推荐的结果，我们是可以直接从业务上判断是好是坏的，其中坏的推荐的比例，就可以作为对推荐系统一个评判的标准。
  
  &emsp;&emsp;比如，对于天猫，淘宝这类电商网站，给用户推荐他已经购买过的商品，往往就不是一个比较好的结果。但是推荐已经购买过的商品的周边商品，这个结果就比较好。就比如用户购买了一个鼠标，用户再去购买鼠标的概率就比较低，但是如果推荐一个配套的鼠标垫，鼠标贴，用户去购买的可能性就会比较高。  
  &emsp;&emsp;对于一个音乐类的内容推荐系统，如果用户是某一个歌星的粉丝，那么再去给他推荐这个歌星的其他的歌或者专辑，意义就不是那么大，因为这些内容用户通常都会主动搜索。再比如对一个新闻类的内容推荐系统，如果推荐给用户的新闻包含了很多"过时"的内容，或者推荐很久之前的帖子，那么显然也不是一个好的推荐
  

- 基于指标的评判标准  
  &emsp;&emsp;通常对于业务系统的评价，还是会回归到业务的本身。所以对于推荐系统最常见的评判标准，还是通过一定的业务指标来衡量。例如常见的PV、UV、用户留存率、转化率等等，通过比对上推荐系统之前和之后的指标数据，来衡量一个推荐系统是不是有效，或者拿推荐系统优化前后的数据进行比较，来看推荐系统的优化是否有效。比如对于猫眼这样的购票系统，最直接的衡量标准就是推荐系统带来的流量和收入的增长
  &emsp;&emsp;另外，对于推荐系统，还有⼀个⾮常重要的指标就是推荐产品的覆盖率，也就是推荐出来的产品应该要越丰富越  好。这是为什么呢？这就涉及到了电商的⼀个根本性的理论模型-"⻓尾经济模型"。商品的交易⾏为，通常都会遵循
  ⼀个普遍性的2-8理论，即80%的利润出⾃于20%的商品。⽐如我们去超市购物，通常也都⽐较喜欢购买最热⻔的， 品牌印象⼒⼤的商品。所以当我们以产品为X轴，产品带来的利润为Y轴，经过整理通常都能得到⼀个这样的正态分布图
  ![商品利润正态分布图](https://raw.githubusercontent.com/aj-web/picturebed/master/%E5%95%86%E5%93%81%E5%88%A9%E6%B6%A6%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83.png)   
  

- 基于机器学习的评判标准  
  &emsp;&emsp;通常推荐系统需要结合⼤量的业务数据，通过对历史数据的挖掘、分析，归纳出⽤⼾与产品之间的⼀些关系。这些  关系通常过于隐晦，有些是能够进⾏解释的特征，⽐如⽤⼾的爱好、产品的受众特点等。但是往往还有很多隐藏的关系是⽆法⽤简单的常理来解释的。这些关系就要通过机器学习的算法来进⾏深⼊挖掘。最终通过这些分析，所以现在业界普遍的推荐系统都是基于机器学习算法来完成的。⽽每⼀个机器学习的算法，都会有他⾃⼰的评判指标和优化⽅式
  

# 3 推荐系统-机器学习基础


## 3.1 机器学习的起源： 
- **机器学习的5个学派：**  

1. 符号主义(Symbolism)，也称为逻辑主义，强调认知即计算，通过对符号的演绎和逆演绎进行结果预测，最喜欢的算法是：规则和决策树。  
   
2. 连接主义(Connectionists)，强调的是从仿⽣学的⻆度，对大脑进行仿真，使用概率矩阵和加权神经元来动态地识别和归纳模式，最喜欢的算法是：深度学习
   。  
3. ⾏为主义(Analogizer)，强调新旧知识间的相似性 ，代表算法:核机器（Kernel machines）、近邻算法（Nearest Neightor）
   
4. 贝叶斯派(Bayesians)：获取发生的可能性来进行概率推理，强调主观概率估计，发生概率修正，最优决策，最喜欢的算法是：朴素贝叶斯或马尔可夫

5. 进化主义(Evolutionaries):强调对进化进行模拟，使用遗传算法和遗传编程

- **机器学习的应⽤领域是⾮常多的，⼤体上，可以分为三个主要的⽅向：**
1. 传统预测：主要⽤在数据挖掘，预测领域。典型的应⽤场景： 店铺销量预测、房价预测、垃圾邮件安全监测等。包括我们这个课程的推荐系统，其实⼤体上也可以分到这⼀类。当然，这也并不是绝对的。基于神经⽹络 的推荐系统也是有很多落地实现的
2. 图像识别：典型应⽤场景：⾃动驾驶、⼈脸识别、涉⻩图⽚视频过滤等
3. ⾃然语⾔处理：典型应⽤场景：⽂本分类、聊天机器⼈、智能客服、⽂本翻译等。其实我们能感觉到，早期的  百度中英⽂翻译就⾮常难懂，语法⾮常混乱。但是现在百度中英⽂翻译就相当⼈性化了，语法也⾮常⾃然。这 其中就有深度学习参与其中。

## 3.2 机器学习数据
&emsp;&emsp;机器学习有三个关键词： 数据，模型，预测。机器学习强调从历史数据中⾃动学习，对数据之间的规律进⾏归
纳，形成模型，然后⽤模型来对实际问题进⾏预测。这个过程跟⼈类理解⼀个事物的过程是很类似的。回想⼀下，⼈类去分辨猫和狗、或者预测房价未来的⾛势，其实也是这样⼀个过程。⼈需要从⼤量的⽇常⽣活经验中归纳出⼀系列的规律，然后在⾯临具体问题时，就可以从众多规律中找到最优化的规律，来解决⽇常问题。
![机器学习数据结构](https://raw.githubusercontent.com/aj-web/picturebed/master/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png)


&emsp;&emsp;⽐如像这样⼀个房价数据，每⼀⾏数据称之为⼀个样本。多个样本就构成了⼀个数据集。⽽在每个样本当中，前⾯  部分房⼦的各个属性构成了特征值，代表样本的各个数据特征。⽽最后的⽬标值相当于是样本的结果。⽽机器学习的  过程就是要从已有的房价数据中学习到房价之间的规律，然后以后再来⼀个房⼦，我们就可以根据房⼦的这些属性，  预测他的房价是多少。⽽在数据集中，特征值是必不可少的，⼀般就是原始数据。⽽⽬标值有可能需要通过对数据进
⾏处理来获得，但是有些数据集是可以没有⽬标值的。
## 3.3 机器学习算法分类
&emsp;&emsp;机器学习涉及到⾮常多的数学算法。对这些数学算法，进⾏简单分类。
![机器学习算法分类](https://raw.githubusercontent.com/aj-web/picturebed/master/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E5%88%86%E7%B1%BB.png)
&emsp;&emsp;1.监督学习算法 (Supervised Algorithms）:在监督学习训练过程中，可以由训练数据集学到或建立一个模式（函数 / learning model），并依此模式推测新的实例。该算法要求特定的输入/输出，首先需要决定使用哪种数据作为范例。例如，文字识别应用中一个手写的字符，或一行手写文字。主要算法包括神经网络、支持向量机、最近邻居法、朴素贝叶斯法、决策树等。   
&emsp;&emsp;2.无监督学习算法 (Unsupervised Algorithms):这类算法没有特定的目标输出，算法将数据集分为不同的组。(聚类)  
&emsp;&emsp;3.强化学习算法 (Reinforcement Algorithms):强化学习普适性强，主要基于决策进行训练，算法根据输出结果（决策）的成功或错误来训练自己，通过大量经验训练优化后的算法将能够给出较好的预测。类似有机体在环境给予的奖励或惩罚的刺激下，逐步形成对刺激的预期，产生能获得最大利益的习惯性行为。在运筹学和控制论的语境下，强化学习被称作“近似动态规划”（approximate dynamic programming，ADP）。

## 3.4 怎么获取数据集？
&emsp;&emsp;在实际业务中，这些有⽤的数据集成本巨⼤，甚⾄可能包含了很多核⼼的商业机密。那在学习阶段，我们要怎么去  获得有价值的数据集呢？主要还是通过直接使⽤别⼈维护好的数据集。

```
⾏业内有很多科研⼈员都维护了很多质量⾮常⾼的开源数据集。例如python的sklearn框架就集成了⼀部分常⽤的数据集。

参⻅pycharm中的Demo: sklearn_datasets.py，加载sklearn本地的Iris鸢尾花数据集，还有也加载了
Boston波斯顿房价数据集。这两个数据集是机器学习领域最为经典的数据集。Iris就是分类问题数据集， Boston则是回归问题数据集。

⽽在java领域，可以使⽤Spark的mllib包来做机器学习。也可以将这些csv⽂件读到spark当中。参⻅SparkDemo中的
LoadDataDemo。
```
UCI： http://archive.ics.uci.edu/ml/  这个⽹站上维护了很多经典的数据集。  
kaggle： https://www.kaggle.com/  ⼀个综合性的机器学习竞赛平台。上⾯会开放很多数据集，开展很多机器学习的竞赛。有很多都是⼀些公司⾃⼰处理不了的实际数据，数据集的质量通常都是⽐较⾼的。同时也有很多别⼈分享  的基础教程以及算法分享，也都是⾮常不错的学习资料。










&emsp;&emsp;关于机器学习，有⼀本⾮常经典的⼊⻔资料，就是周志华的《机器学习》，俗称为西⽠书。因封⾯有很多西⽠，并且全篇很     多问题都从西⽠谈起⽽得名。
![西瓜书](https://raw.githubusercontent.com/aj-web/picturebed/master/%E8%A5%BF%E7%93%9C%E4%B9%A6.png)

⽽关于深度学习，也有⼀本⾮常经典的资料，名字就叫做《Deep leaning》，深度学习。俗称为花书，因封⾯有⾮常多的花
⽽得名。
![花书](https://raw.githubusercontent.com/aj-web/picturebed/master/%E8%8A%B1%E4%B9%A6.jpg)

# 总结：
![机器学习在推荐系统中的应用总结](https://raw.githubusercontent.com/aj-web/picturebed/master/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93.png)